# GLGROUP Mapping Extension for data_mapping.py
# ADD THIS TO THE END OF data_mapping.py

"""
GLGROUP (หมวดบัญชี) Mapping
Maps row labels to CSV GROUP/SUB_GROUP for GL Group dimension

Structure: Simple GROUP → SUB_GROUP mapping (no nested MAIN_GROUP)
"""

# GLGROUP uses direct GROUP → SUB_GROUP mapping
GLGROUP_MAPPING = {
    # Revenue items (GROUP 01)
    "- รายได้กลุ่มธุรกิจโครงสร้างพื้นฐาน": ("01.รายได้", "รายได้กลุ่มธุรกิจโครงสร้างพื้นฐาน"),
    "- รายได้กลุ่มธุรกิจโทรศัพท์ประจำที่และบรอดแบนด์": ("01.รายได้", "รายได้กลุ่มธุรกิจโทรศัพท์ประจำที่และบรอดแบนด์"),
    "- รายได้กลุ่มธุรกิจโทรศัพท์เคลื่อนที่": ("01.รายได้", "รายได้กลุ่มธุรกิจโทรศัพท์เคลื่อนที่"),
    "- รายได้กลุ่มธุรกิจวงจรระหว่างประเทศ": ("01.รายได้", "รายได้กลุ่มธุรกิจวงจรระหว่างประเทศ"),
    "- รายได้กลุ่มธุรกิจดิจิทัล": ("01.รายได้", "รายได้กลุ่มธุรกิจดิจิทัล"),
    "- รายได้กลุ่มธุรกิจ ICT Solution Business": ("01.รายได้", "รายได้กลุ่มธุรกิจ ICT Solution Business"),
    "- รายได้จากการให้บริการอื่นที่ไม่ใช่โทรคมนาคม": ("01.รายได้", "รายได้จากการให้บริการอื่นที่ไม่ใช่โทรคมนาคม"),
    "- รายได้จากการขาย": ("01.รายได้", "รายได้จากการขาย"),
    
    # Finance income and other revenue
    "     - ผลตอบแทนทางการเงิน": ("01.รายได้", "ผลตอบแทนทางการเงิน"),
    "     - รายได้อื่น": ("01.รายได้", "รายได้อื่น"),
    
    # Expense items (GROUP 02)
    "- ค่าใช้จ่ายตอบแทนแรงงาน": ("02.ค่าใช้จ่าย", "ค่าใช้จ่ายตอบแทนแรงงาน"),
    "- ค่าสวัสดิการ": ("02.ค่าใช้จ่าย", "ค่าสวัสดิการ"),
    "- ค่าใช้จ่ายพัฒนาและฝึกอบรมบุคลากร": ("02.ค่าใช้จ่าย", "ค่าใช้จ่ายพัฒนาและฝึกอบรมบุคลากร"),
    "- ค่าซ่อมแซมและบำรุงรักษาและวัสดุใช้ไป": ("02.ค่าใช้จ่าย", "ค่าซ่อมแซมและบำรุงรักษาและวัสดุใช้ไป"),
    "- ค่าสาธารณูปโภค": ("02.ค่าใช้จ่าย", "ค่าสาธารณูปโภค"),
    "- ค่าใช้จ่ายการตลาดและส่งเสริมการขาย": ("02.ค่าใช้จ่าย", "ค่าใช้จ่ายการตลาดและส่งเสริมการขาย"),
    "- ค่าใช้จ่ายเผยแพร่ประชาสัมพันธ์": ("02.ค่าใช้จ่าย", "ค่าใช้จ่ายเผยแพร่ประชาสัมพันธ์"),
    "- ค่าใช้จ่ายเกี่ยวกับการกำกับดูแลของ กสทช.": ("02.ค่าใช้จ่าย", "ค่าใช้จ่ายเกี่ยวกับการกำกับดูแลของ กสทช."),
    "- ค่าส่วนแบ่งบริการโทรคมนาคม": ("02.ค่าใช้จ่าย", "ค่าส่วนแบ่งบริการโทรคมนาคม"),
    "- ค่าใช้จ่ายบริการโทรคมนาคม": ("02.ค่าใช้จ่าย", "ค่าใช้จ่ายบริการโทรคมนาคม"),
    "- ค่าเสื่อมราคาและรายจ่ายตัดบัญชีสินทรัพย์": ("02.ค่าใช้จ่าย", "ค่าเสื่อมราคาและรายจ่ายตัดบัญชีสินทรัพย์"),
    "- ค่าตัดจำหน่ายสิทธิการใช้ตามสัญญาเช่า": ("02.ค่าใช้จ่าย", "ค่าตัดจำหน่ายสิทธิการใช้ตามสัญญาเช่า"),
    "- ค่าเช่าและค่าใช้สินทรัพย์": ("02.ค่าใช้จ่าย", "ค่าเช่าและค่าใช้สินทรัพย์"),
    "- ต้นทุนขาย": ("02.ค่าใช้จ่าย", "ต้นทุนขาย"),
    "- ค่าใช้จ่ายบริการอื่น": ("02.ค่าใช้จ่าย", "ค่าใช้จ่ายบริการอื่น"),
    "- ค่าใช้จ่ายดำเนินงานอื่น": ("02.ค่าใช้จ่าย", "ค่าใช้จ่ายดำเนินงานอื่น"),
    "- ค่าใช้จ่ายอื่น": ("02.ค่าใช้จ่าย", "ค่าใช้จ่ายอื่น"),
    "- ต้นทุนทางการเงิน-ด้านการดำเนินงาน": ("02.ค่าใช้จ่าย", "ต้นทุนทางการเงิน-ด้านการดำเนินงาน"),
    "- ต้นทุนทางการเงิน-ด้านการจัดหาเงิน": ("02.ค่าใช้จ่าย", "ต้นทุนทางการเงิน-ด้านการจัดหาเงิน"),
    
    # Summary rows (GROUP 03, 05) - ไม่มี GROUP 04 ในข้อมูล!
    "3.กำไร(ขาดทุน)ก่อนหักภาษีเงินได้ (EBT) (1)-(2)": ("03.กำไร(ขาดทุน)ก่อนหักภาษีเงินได้ (EBT) (1)-(2)", "กำไร(ขาดทุน)ก่อนหักภาษีเงินได้ (EBT) (1)-(2)"),
    "4.ภาษีเงินได้นิติบุคคล": ("04.ภาษีเงินได้นิติบุคคล", "ภาษีเงินได้นิติบุคคล"),  # ไม่มีในข้อมูล!
    "5.กำไร(ขาดทุน) สุทธิ (3)-(4)": ("05.กำไร(ขาดทุน) สุทธิ (3)-(4)", "กำไร(ขาดทุน) สุทธิ (3)-(4)"),
}


def get_group_sub_group_glgroup(label: str):
    """
    Get GROUP and SUB_GROUP for GLGROUP dimension
    
    Args:
        label: Row label from ROW_ORDER_GLGROUP
    
    Returns:
        Tuple of (GROUP, SUB_GROUP) or (None, None) if not found
    """
    return GLGROUP_MAPPING.get(label, (None, None))


def is_calculated_row_glgroup(label: str) -> bool:
    """
    Check if row is calculated for GLGROUP
    
    Args:
        label: Row label
    
    Returns:
        True if this is a calculated row
    """
    from config.row_order_glgroup import ROW_ORDER_GLGROUP
    
    for level, row_label, is_calc, formula, is_bold in ROW_ORDER_GLGROUP:
        if row_label == label:
            return is_calc
    
    return False
