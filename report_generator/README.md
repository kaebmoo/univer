# Univer Report Generator

‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô P&L Excel ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡πÇ‡∏ó‡∏£‡∏Ñ‡∏°‡∏ô‡∏≤‡∏Ñ‡∏°‡πÅ‡∏´‡πà‡∏á‡∏ä‡∏≤‡∏ï‡∏¥ ‡∏à‡∏≥‡∏Å‡∏±‡∏î (‡∏°‡∏´‡∏≤‡∏ä‡∏ô)

## üìã ‡∏™‡∏≤‡∏£‡∏ö‡∏±‡∏ç

- [‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥](#-‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥)
- [‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ](#-‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ)
- [‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á](#-‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á)
- [‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô](#-‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô)
- [‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤](#-‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤)
- [‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•](#-‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)
- [‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á](#-‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á)
- [‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå](#-‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå)

---

## ‚ú® ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥

### ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö 2 ‡∏°‡∏¥‡∏ï‡∏¥‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
- **COSTTYPE** - ‡∏°‡∏¥‡∏ï‡∏¥‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô
- **GLGROUP** - ‡∏°‡∏¥‡∏ï‡∏¥‡∏´‡∏°‡∏ß‡∏î‡∏ö‡∏±‡∏ç‡∏ä‡∏µ

### ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö 2 ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤
- **MTH** - ‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (Monthly)
- **YTD** - ‡∏™‡∏∞‡∏™‡∏°‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏ô‡∏õ‡∏µ (Year-to-Date)

### ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö 3 ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î
- **BU_ONLY** - ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
- **BU_SG** - ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à + ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£
- **BU_SG_PRODUCT** - ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à + ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ + ‡∏£‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ (default)

---

## üìÅ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ

```
report_generator/
‚îú‚îÄ‚îÄ generate_report.py      # ‚úÖ Entry point ‡∏´‡∏•‡∏±‡∏Å (‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á)
‚îú‚îÄ‚îÄ main.py                 # ‚ö†Ô∏è ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö CLI/Web mode (‡∏ï‡πâ‡∏≠‡∏á refactor)
‚îú‚îÄ‚îÄ main_generator.py       # ‚ùå Legacy code (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß)
‚îú‚îÄ‚îÄ .env                    # ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏ö‡∏ö environment
‚îú‚îÄ‚îÄ requirements.txt        # Dependencies
‚îÇ
‚îú‚îÄ‚îÄ config/                 # ‚öôÔ∏è Configuration files
‚îÇ   ‚îú‚îÄ‚îÄ settings.py         # ‚úÖ ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏´‡∏•‡∏±‡∏Å (‡∏≠‡πà‡∏≤‡∏ô‡∏à‡∏≤‡∏Å .env)
‚îÇ   ‚îú‚îÄ‚îÄ data_mapping.py     # ‚úÖ COSTTYPE: Label ‚Üí (GROUP, SUB_GROUP)
‚îÇ   ‚îú‚îÄ‚îÄ data_mapping_glgroup.py  # ‚úÖ GLGROUP: Label ‚Üí (GROUP, SUB_GROUP)
‚îÇ   ‚îú‚îÄ‚îÄ row_order.py        # ‚úÖ COSTTYPE: ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÅ‡∏ñ‡∏ß‡πÅ‡∏•‡∏∞ formulas
‚îÇ   ‚îú‚îÄ‚îÄ row_order_glgroup.py    # ‚úÖ GLGROUP: ‡∏•‡∏≥‡∏î‡∏±‡∏ö‡πÅ‡∏ñ‡∏ß‡πÅ‡∏•‡∏∞ formulas
‚îÇ   ‚îú‚îÄ‚îÄ report_config.py    # ‚ö†Ô∏è Legacy (‡πÉ‡∏ä‡πâ core/config.py ‡πÅ‡∏ó‡∏ô)
‚îÇ   ‚îî‚îÄ‚îÄ types.py            # ‚úÖ Enum definitions
‚îÇ
‚îú‚îÄ‚îÄ data/                   # üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Input
‚îÇ   ‚îú‚îÄ‚îÄ TRN_PL_COSTTYPE_NT_MTH_TABLE_*.csv
‚îÇ   ‚îú‚îÄ‚îÄ TRN_PL_COSTTYPE_NT_YTD_TABLE_*.csv
‚îÇ   ‚îú‚îÄ‚îÄ TRN_PL_GLGROUP_NT_MTH_TABLE_*.csv
‚îÇ   ‚îú‚îÄ‚îÄ TRN_PL_GLGROUP_NT_YTD_TABLE_*.csv
‚îÇ   ‚îî‚îÄ‚îÄ remark_YYYYMMDD.txt # ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ (‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà CSV)
‚îÇ
‚îú‚îÄ‚îÄ output/                 # üì§ ‡πÑ‡∏ü‡∏•‡πå Output Excel
‚îÇ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ data_loader/        # ‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ csv_loader.py       # ‡∏≠‡πà‡∏≤‡∏ô CSV
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ data_processor.py   # ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏• DataFrame
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ data_aggregator.py  # ‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ report_generator/   # ‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô Excel
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py       # ReportConfig, Enums
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ report_builder.py  # ‡∏ï‡∏±‡∏ß‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏Å
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ columns/            # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rows/               # ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ñ‡∏ß
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ writers/            # ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏•‡∏á Excel
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ formatters/         # ‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö cells
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ cli/               # ‚ö†Ô∏è ‡∏ï‡πâ‡∏≠‡∏á refactor
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cli.py             # ‚ùå ‡πÉ‡∏ä‡πâ ExcelGenerator ‡πÄ‡∏Å‡πà‡∏≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ commands.py        # ‚ö†Ô∏è load_remark_file ‡∏°‡∏µ bug
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ web/               # üöß ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà implement
‚îÇ   ‚îî‚îÄ‚îÄ calculators/       # üöß placeholder
‚îÇ
‚îú‚îÄ‚îÄ archive/               # üì¶ Code ‡πÄ‡∏Å‡πà‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ
‚îî‚îÄ‚îÄ backup_*/              # üíæ Backups
```

---

## üöÄ ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á

### 1. Clone ‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á dependencies

```bash
cd report_generator
pip install -r requirements.txt
```

### 2. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ .env (optional)

‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å `.env.example` ‡πÄ‡∏õ‡πá‡∏ô `.env` ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£:

```bash
cp .env.example .env
```

---

## üíª ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô

```bash
# ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô COSTTYPE MTH (default)
python generate_report.py

# ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô GLGROUP YTD
python generate_report.py --report-type GLGROUP --period YTD

# ‡∏£‡∏∞‡∏ö‡∏∏‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î
python generate_report.py --detail-level BU_SG

# ‡∏£‡∏∞‡∏ö‡∏∏‡πÑ‡∏ü‡∏•‡πå CSV ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á
python generate_report.py --csv-file data/TRN_PL_COSTTYPE_NT_MTH_TABLE_20251031.csv
```

### Options ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î

| Option | Short | Description | Default |
|--------|-------|-------------|---------|
| `--csv-file` | | ‡πÑ‡∏ü‡∏•‡πå CSV (auto-detect ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏) | - |
| `--data-dir` | | Directory ‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• | `data/` |
| `--output` | `-o` | ‡πÑ‡∏ü‡∏•‡πå Output | auto-generated |
| `--output-dir` | | Directory ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö output | `output/` |
| `--report-type` | `-t` | COSTTYPE ‡∏´‡∏£‡∏∑‡∏≠ GLGROUP | COSTTYPE |
| `--period` | `-p` | MTH ‡∏´‡∏£‡∏∑‡∏≠ YTD | MTH |
| `--detail-level` | `-d` | BU_ONLY, BU_SG, BU_SG_PRODUCT | BU_SG_PRODUCT |
| `--encoding` | | CSV encoding | tis-620 |
| `--verbose` | `-v` | ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î | False |

---

## ‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤

### ‡πÑ‡∏ü‡∏•‡πå .env

```ini
# === Application ===
APP_NAME="Univer Report Generator"
APP_ENV=development
DEBUG=True

# === Data Paths ===
DATA_DIR=data           # Directory ‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå CSV
OUTPUT_DIR=output       # Directory ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö output

# === CSV Encoding ===
CSV_ENCODING=tis-620    # ‡∏´‡∏£‡∏∑‡∏≠ windows-874, cp874

# === Excel Formatting ===
EXCEL_FONT_NAME=TH Sarabun New
EXCEL_FONT_SIZE=18

# === Web Server (‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ) ===
WEB_HOST=0.0.0.0
WEB_PORT=9000
```

### ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏≠‡πà‡∏≤‡∏ô‡∏à‡∏≤‡∏Å .env

| Variable | Description | Default |
|----------|-------------|---------|
| `DATA_DIR` | Directory ‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå CSV | `../data` |
| `OUTPUT_DIR` | Directory ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö output | `./output` |
| `CSV_ENCODING` | Encoding ‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå CSV | `tis-620` |
| `EXCEL_FONT_NAME` | ‡∏ü‡∏≠‡∏ô‡∏ï‡πå‡πÉ‡∏ô Excel | `TH Sarabun New` |
| `EXCEL_FONT_SIZE` | ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ü‡∏≠‡∏ô‡∏ï‡πå | `18` |

---

## üìä ‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•

### CSV Files (Input)

‡πÑ‡∏ü‡∏•‡πå CSV ‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô `data/` directory ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ä‡∏∑‡πà‡∏≠:

```
TRN_PL_{REPORT_TYPE}_NT_{PERIOD}_TABLE_{YYYYMMDD}.csv

‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:
- TRN_PL_COSTTYPE_NT_MTH_TABLE_20251031.csv
- TRN_PL_COSTTYPE_NT_YTD_TABLE_20251031.csv
- TRN_PL_GLGROUP_NT_MTH_TABLE_20251031.csv
- TRN_PL_GLGROUP_NT_YTD_TABLE_20251031.csv
```

### Remark File

‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô `data/` directory ‡πÇ‡∏î‡∏¢‡∏°‡∏µ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ä‡∏∑‡πà‡∏≠:

```
remark_{YYYYMMDD}.txt

‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:
- remark_20251031.txt
```

**‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:** ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô remark file ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ô CSV file

**Encoding:** ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö UTF-8, TIS-620, CP874, Windows-874

---

## üîß ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á

### 1. ‡πÄ‡∏û‡∏¥‡πà‡∏°/‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏ñ‡∏ß‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô

#### COSTTYPE: ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç `config/row_order.py`

```python
ROW_ORDER = [
    # (level, label, is_calculated, formula, is_bold)
    (0, "1.‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ", False, None, True),
    (1, "‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£", True, "sum_service_revenue", False),
    (2, "- ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô", False, None, False),
    ...
]
```

#### GLGROUP: ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç `config/row_order_glgroup.py`

```python
ROW_ORDER_GLGROUP = [
    # (level, label, is_calculated, formula, is_bold)
    (0, "1 ‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ", True, "sum_group_1", True),
    (1, "- ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô", False, None, False),
    ...
]
```

### 2. Mapping Labels ‡∏Å‡∏±‡∏ö Database

#### COSTTYPE: ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç `config/data_mapping.py`

```python
DATA_MAPPING = {
    "- ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô": ("01.‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ", "01.‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£"),
    ...
}

# Context-dependent mappings
CONTEXT_MAPPING = {
    ("label", "parent_context"): ("GROUP", "SUB_GROUP"),
    ...
}
```

#### GLGROUP: ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç `config/data_mapping_glgroup.py`

```python
DATA_MAPPING_GLGROUP = {
    "- ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô": ("01.‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ", "01.‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£"),
    # ‡∏ö‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡πá‡∏ô 3-tuple:
    "     - ‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô": ("01.‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ", "10.‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô", "8.1 ‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô"),
    ...
}
```

### 3. ‡∏™‡∏µ‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à

‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ô `config/settings.py` ‡∏´‡∏£‡∏∑‡∏≠ `src/report_generator/core/config.py`:

```python
bu_colors: Dict[str, str] = {
    '1.‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à HARD INFRASTRUCTURE': 'E2EFDA',
    '2.‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à INTERNATIONAL': 'DDEBF7',
    ...
}
```

### 4. Formulas ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Calculated Rows

Formulas ‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö (‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏ô `row_order*.py`):

**COSTTYPE:**
- `sum_service_revenue` - ‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£
- `sum_total_revenue` - ‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
- `sum_total_cost` - ‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
- `sum_service_cost_*` - ‡∏£‡∏ß‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≤‡∏á‡πÜ
- `subtract_*` - ‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á (‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ - ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢)
- `ebitda` - EBITDA

**GLGROUP:**
- `sum_group_1` - ‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ (9 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)
- `sum_group_2` - ‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ (19 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)
- `sum_service_revenue` - ‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£
- `total_expense_no_finance` - ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô
- `total_expense_with_finance` - ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏ß‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô
- `ebitda` - EBITDA

---

## üìã ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå

### ‚úÖ ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á

| File | Description |
|------|-------------|
| `generate_report.py` | Entry point ‡∏´‡∏•‡∏±‡∏Å |
| `config/settings.py` | ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö |
| `config/data_mapping.py` | COSTTYPE mappings |
| `config/data_mapping_glgroup.py` | GLGROUP mappings |
| `config/row_order.py` | COSTTYPE row definitions |
| `config/row_order_glgroup.py` | GLGROUP row definitions |
| `config/types.py` | Enum definitions |
| `src/data_loader/*` | Data loading modules |
| `src/report_generator/*` | Report generation modules |

### ‚ö†Ô∏è ‡∏ï‡πâ‡∏≠‡∏á‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á

| File | Issue |
|------|-------|
| `main.py` | ‡πÉ‡∏ä‡πâ cli.py ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ |
| `src/cli/cli.py` | Import ExcelGenerator ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÅ‡∏•‡πâ‡∏ß |
| `src/cli/commands.py` | `load_remark_file()` ‡∏°‡∏µ bug |
| `config/report_config.py` | Legacy (‡πÉ‡∏ä‡πâ `core/config.py` ‡πÅ‡∏ó‡∏ô) |

### ‚ùå ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß (‡∏Ñ‡∏ß‡∏£‡∏•‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡πâ‡∏≤‡∏¢)

| File | Reason |
|------|--------|
| `main_generator.py` | Legacy hardcoded version |
| `src/data_loader/*.bak` | Backup files |
| `archive/` | Old implementations |
| `backup_*/` | Old backups |

### üöß ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà implement

| File | Status |
|------|--------|
| `src/web/*` | Placeholder (FastAPI web interface) |
| `src/calculators/*` | Placeholder |

---

## üîÑ ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á

### ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ CSV ‡πÉ‡∏´‡∏°‡πà

1. ‡∏ß‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå CSV ‡πÉ‡∏ô `data/` directory
2. ‡∏™‡∏£‡πâ‡∏≤‡∏á remark file ‡πÉ‡∏´‡∏°‡πà (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ): `remark_YYYYMMDD.txt`
3. ‡∏£‡∏±‡∏ô `python generate_report.py` (auto-detect ‡πÑ‡∏ü‡∏•‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î)

### ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡πÅ‡∏ñ‡∏ß‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà

1. ‡πÄ‡∏û‡∏¥‡πà‡∏° mapping ‡πÉ‡∏ô `config/data_mapping*.py`
2. ‡πÄ‡∏û‡∏¥‡πà‡∏° row definition ‡πÉ‡∏ô `config/row_order*.py`
3. ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô calculated row ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏° logic ‡πÉ‡∏ô `data_aggregator.py`

### ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡πÉ‡∏´‡∏°‡πà

1. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏µ‡πÉ‡∏ô `bu_colors` ‡∏Ç‡∏≠‡∏á `config/settings.py`
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ CSV ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤ BU ‡πÉ‡∏´‡∏°‡πà

---

## üìù Notes

- **Encoding:** ‡πÑ‡∏ü‡∏•‡πå CSV ‡∏à‡∏≤‡∏Å SAP ‡πÉ‡∏ä‡πâ TIS-620 encoding
- **Font:** ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á TH Sarabun New ‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á
- **Output:** ‡πÑ‡∏ü‡∏•‡πå output ‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏û‡∏£‡πâ‡∏≠‡∏° timestamp

---

## üìû Support

‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏° ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ó‡∏µ‡∏°‡∏û‡∏±‡∏í‡∏ô‡∏≤
