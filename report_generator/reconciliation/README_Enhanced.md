# ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô: ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô P&L (Enhanced Version)

## üìã ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°

‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô P&L ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏° ‡πÇ‡∏î‡∏¢‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö:

- ‚úÖ **‡∏ó‡∏∏‡∏Å Sheet** - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏£‡∏ö 6 sheets (3 ‡∏°‡∏¥‡∏ï‡∏¥‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô + 3 ‡∏°‡∏¥‡∏ï‡∏¥ GL)
- ‚úÖ **‡∏ó‡∏±‡πâ‡∏á MTH ‡πÅ‡∏•‡∏∞ YTD** - ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏∞‡∏™‡∏°
- ‚úÖ **3 ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö** - ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô, ‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á, ‡πÅ‡∏•‡∏∞ Tie-out ‡∏Å‡∏±‡∏ö‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô

---

## üéØ ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö 3 ‡∏£‡∏∞‡∏î‡∏±‡∏ö

### ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà 1: ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô (Completeness)
‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å CSV ‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö‡∏ñ‡∏π‡∏Å‡∏ô‡∏≥‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô Excel Report ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô

**‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à:**
- ‚úì ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å CSV (Cost Type) = ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÉ‡∏ô Report (Sheet ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô)
- ‚úì ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å CSV (GL Group) = ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÉ‡∏ô Report (Sheet GL)
- ‚úì ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏à‡∏≤‡∏Å CSV (Cost Type) = ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡πÉ‡∏ô Report
- ‚úì ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏à‡∏≤‡∏Å CSV (GL Group) = ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡πÉ‡∏ô Report

**‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:**
```
Œ£(Value in Source CSV) = Grand Total in Excel Report
```

### ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà 2: ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á (Cross-Sheet Consistency)
‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏°‡∏µ 2 ‡∏°‡∏¥‡∏ï‡∏¥ (Cost Type ‡πÅ‡∏•‡∏∞ GL Group) ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô‡πÅ‡∏ï‡πà‡∏°‡∏≠‡∏á‡∏Ñ‡∏ô‡∏•‡∏∞‡∏°‡∏∏‡∏° ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô

**‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à:**
- ‚úì ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ (‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô_‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à) = ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ (‡∏´‡∏°‡∏ß‡∏î‡∏ö‡∏±‡∏ç‡∏ä‡∏µ_‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à)
- ‚úì ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ (‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô_‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£) = ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ (‡∏´‡∏°‡∏ß‡∏î‡∏ö‡∏±‡∏ç‡∏ä‡∏µ_‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£)
- ‚úì ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ (‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô_‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£) = ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ (‡∏´‡∏°‡∏ß‡∏î‡∏ö‡∏±‡∏ç‡∏ä‡∏µ_‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£)

**‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:**
```
Net Profit (Cost Type) = Net Profit (GL Group)
```

### ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà 3: ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏¢‡∏≠‡∏î‡∏Å‡∏±‡∏ö‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô (Financial Tie-out)
‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ß‡πà‡∏≤‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô Excel ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£ (Text File)

**‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à:**
- ‚úì ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡πÉ‡∏ô Excel = ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡πÉ‡∏ô‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô (Text)

**‡∏™‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:**
```
Net Profit (Excel Report) = Net Profit (Financial Statement)
```

---

## üìÅ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå

```
report_generator/reconciliation/
‚îú‚îÄ‚îÄ pl_reconciliation_enhanced.py      # ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏´‡∏•‡∏±‡∏Å (Enhanced Version)
‚îú‚îÄ‚îÄ pl_reconciliation_combined.py      # ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Combined Output
‚îú‚îÄ‚îÄ pl_reconciliation.py               # ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡πÄ‡∏î‡∏¥‡∏° (Basic Version)
‚îú‚îÄ‚îÄ README_Enhanced.md                 # ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏ô‡∏µ‡πâ
‚îú‚îÄ‚îÄ Reconciliation.md                  # ‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡πÅ‡∏•‡∏∞‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£
‚îÇ
‚îú‚îÄ‚îÄ Report_NT_202510.xlsx              # ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô MTH (‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)
‚îú‚îÄ‚îÄ Report_NT_2025.xlsx                # ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô YTD (‡∏™‡∏∞‡∏™‡∏°)
‚îú‚îÄ‚îÄ pl_combined_output_202510.xlsx     # ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö‡∏£‡∏ß‡∏° (Combined)
‚îÇ
‚îú‚îÄ‚îÄ TRN_PL_COSTTYPE_NT_MTH_TABLE_20251031.csv    # Source: Cost Type (MTH)
‚îú‚îÄ‚îÄ TRN_PL_COSTTYPE_NT_YTD_TABLE_20251031.csv    # Source: Cost Type (YTD)
‚îú‚îÄ‚îÄ TRN_PL_GLGROUP_NT_MTH_TABLE_20251031.csv     # Source: GL Group (MTH)
‚îú‚îÄ‚îÄ TRN_PL_GLGROUP_NT_YTD_TABLE_20251031.csv     # Source: GL Group (YTD)
‚îÇ
‚îî‚îÄ‚îÄ pld_nt_20251031.txt                # ‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô (‡∏°‡∏µ‡∏ó‡∏±‡πâ‡∏á MTH ‡πÅ‡∏•‡∏∞ YTD)
```

---

## üöÄ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### **‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Dependencies**

```bash
# ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Python packages ‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô
pip install pandas openpyxl
```

**Requirements:**
- Python 3.7 ‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ
- pandas >= 1.3.0
- openpyxl >= 3.0.0

---

### **‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÑ‡∏ü‡∏•‡πå**

‡∏ß‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô folder `report_generator/reconciliation/`:

#### **‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô Excel (Enhanced Version):**

**‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ (‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô - MTH):**
```
‚úì Report_NT_202510.xlsx                          # ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô Excel (6 sheets)
‚úì TRN_PL_COSTTYPE_NT_MTH_TABLE_20251031.csv     # ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á Cost Type
‚úì TRN_PL_GLGROUP_NT_MTH_TABLE_20251031.csv      # ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á GL Group
‚úì pld_nt_20251031.txt                           # ‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô (column 1 = MTH)
```

**‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ (‡∏™‡∏∞‡∏™‡∏° - YTD):**
```
‚úì Report_NT_2025.xlsx                           # ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô Excel (6 sheets)
‚úì TRN_PL_COSTTYPE_NT_YTD_TABLE_20251031.csv     # ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á Cost Type
‚úì TRN_PL_GLGROUP_NT_YTD_TABLE_20251031.csv      # ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á GL Group
‚úì pld_nt_20251031.txt                           # ‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô (column 2 = YTD)
```

#### **‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Combined Output:**

**‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ:**
```
‚úì pl_combined_output_202510.xlsx                # ‡πÑ‡∏ü‡∏•‡πå Combined (3 sheets)
‚úì TRN_PL_GLGROUP_NT_MTH_TABLE_20251031.csv      # ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á MTH
‚úì TRN_PL_GLGROUP_NT_YTD_TABLE_20251031.csv      # ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á YTD
```

---

### **‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤ Configuration**

#### **‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤ Default (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)**

‡∏ñ‡πâ‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡∏∞‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÑ‡∏ß‡πâ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏≠‡∏∞‡πÑ‡∏£ ‡∏£‡∏±‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢

#### **‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô Code**

‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå `pl_reconciliation_enhanced.py` ‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô `main()`:

```python
def main():
    # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î Configuration ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (MTH)
    config_mth = FileConfig(
        period_type=PeriodType.MTH,
        report_excel='report_generator/reconciliation/Report_NT_202510.xlsx',  # ‚Üê ‡πÅ‡∏Å‡πâ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
        source_cost_csv='report_generator/reconciliation/TRN_PL_COSTTYPE_NT_MTH_TABLE_20251031.csv',
        source_gl_csv='report_generator/reconciliation/TRN_PL_GLGROUP_NT_MTH_TABLE_20251031.csv',
        financial_stmt_txt='report_generator/reconciliation/pld_nt_20251031.txt'
    )

    # ‡∏Å‡∏≥‡∏´‡∏ô‡∏î Configuration ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏∞‡∏™‡∏° (YTD)
    config_ytd = FileConfig(
        period_type=PeriodType.YTD,
        report_excel='report_generator/reconciliation/Report_NT_2025.xlsx',  # ‚Üê ‡πÅ‡∏Å‡πâ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
        source_cost_csv='report_generator/reconciliation/TRN_PL_COSTTYPE_NT_YTD_TABLE_20251031.csv',
        source_gl_csv='report_generator/reconciliation/TRN_PL_GLGROUP_NT_YTD_TABLE_20251031.csv',
        financial_stmt_txt='report_generator/reconciliation/pld_nt_20251031.txt'  # ‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô
    )
```

**‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:**
- ‡πÑ‡∏ü‡∏•‡πå‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô Text ‡∏°‡∏µ **2 columns** ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß:
  - Column 1 (index 0) = ‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (MTH)
  - Column 2 (index 1) = ‡∏™‡∏∞‡∏™‡∏° (YTD)
- ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏à‡∏∞‡πÄ‡∏•‡∏∑‡∏≠‡∏Å column ‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ï‡∏≤‡∏° `period_type`

---

### **‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 4: ‡∏£‡∏±‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°**

#### **‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô Excel (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥):**

```bash
# ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏ó‡∏µ‡πà folder ‡∏´‡∏•‡∏±‡∏Å
cd /Users/seal/Documents/GitHub/univer

# ‡∏£‡∏±‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
python3 report_generator/reconciliation/pl_reconciliation_enhanced.py
```

#### **‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Combined Output:**

```bash
python3 report_generator/reconciliation/pl_reconciliation_combined.py
```

#### **‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡πÄ‡∏î‡∏¥‡∏° (Basic):**

```bash
python3 report_generator/reconciliation/pl_reconciliation.py
```

---

## üìä ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå

### **1. ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô Excel (Enhanced Version)**

#### **‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö:**

```bash
# ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á MTH ‡πÅ‡∏•‡∏∞ YTD ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô
python3 report_generator/reconciliation/pl_reconciliation_enhanced.py
```

#### **‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏à‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:**

**‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏á‡∏ß‡∏î (MTH ‡πÅ‡∏•‡∏∞ YTD):**

| # | ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö | ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î |
|---|--------------|-----------|
| **1. Completeness - Cost Type** | |
| 1.1a | ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ | Source CSV vs Excel Report (‡πÉ‡∏ä‡πâ "‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£") |
| 1.1b | ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ | Source CSV vs Excel Report |
| **2. Completeness - GL Group** | |
| 1.2a | ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ | Source CSV vs Excel Report (‡πÉ‡∏ä‡πâ "‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ") |
| 1.2b | ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ | Source CSV vs Excel Report |
| **3. Cross-Sheet Consistency** | |
| 2.1 | ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à | ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô_‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à vs ‡∏´‡∏°‡∏ß‡∏î‡∏ö‡∏±‡∏ç‡∏ä‡∏µ_‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à |
| 2.2 | ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ | ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô_‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ vs ‡∏´‡∏°‡∏ß‡∏î‡∏ö‡∏±‡∏ç‡∏ä‡∏µ_‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ |
| 2.3 | ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ | ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô_‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ vs ‡∏´‡∏°‡∏ß‡∏î‡∏ö‡∏±‡∏ç‡∏ä‡∏µ_‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ |
| **4. Financial Tie-out** | |
| 3 | ‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô | Excel Report vs Text File |

**‡∏£‡∏ß‡∏°:** 8 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ï‡πà‡∏≠ 1 ‡∏á‡∏ß‡∏î ‚Üí **‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î 16 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£**

---

### **‚úÖ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå - ‡∏Å‡∏£‡∏ì‡∏µ‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ (MTH)**

```
====================================================================================================
‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö: MTH
====================================================================================================

üìä ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà 1: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô (Completeness)
--------------------------------------------------------------------------------

üîÑ ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà 2: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á (Cross-Sheet Consistency)
--------------------------------------------------------------------------------

‚úì ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà 3: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Tie-out (Financial Statement)
--------------------------------------------------------------------------------

====================================================================================================
                                          ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
====================================================================================================
‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö                                      |        ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
====================================================================================================
1.1a Revenue: Source Cost vs Report                |            0.00 | ‚úÖ ‚úÖ PASS
1.1b Net Profit: Source Cost vs Report             |           -0.00 | ‚úÖ ‚úÖ PASS
1.2a Revenue: Source GL vs Report                  |           -0.00 | ‚úÖ ‚úÖ PASS
1.2b Net Profit: Source GL vs Report               |            0.00 | ‚úÖ ‚úÖ PASS
2. Cross-Sheet: ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à                        |            0.00 | ‚úÖ ‚úÖ PASS
2. Cross-Sheet: ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£                        |            0.00 | ‚úÖ ‚úÖ PASS
2. Cross-Sheet: ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£                             |            0.00 | ‚úÖ ‚úÖ PASS
3. Tie-out: Report vs Financial Statement          |           -0.00 | ‚úÖ ‚úÖ PASS
====================================================================================================
‡∏ú‡∏•‡∏£‡∏ß‡∏°: ‡∏ú‡πà‡∏≤‡∏ô 8 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ | ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô 0 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
====================================================================================================
```

**‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏ú‡∏•:**
- ‚úÖ **PASS** = ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ tolerance (default 1.0 ‡∏ö‡∏≤‡∏ó)
- ‚úÖ **8/8 PASS** = ‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á 100%

---

### **‚ö†Ô∏è ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå - ‡∏Å‡∏£‡∏ì‡∏µ‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô (YTD)**

```
====================================================================================================
                                          ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
====================================================================================================
‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö                                      |        ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
====================================================================================================
1.1a Revenue: Source Cost vs Report                |            0.00 | ‚úÖ ‚úÖ PASS
1.1b Net Profit: Source Cost vs Report             |            0.00 | ‚úÖ ‚úÖ PASS
1.2a Revenue: Source GL vs Report                  |            0.00 | ‚úÖ ‚úÖ PASS
1.2b Net Profit: Source GL vs Report               |            0.00 | ‚úÖ ‚úÖ PASS
2. Cross-Sheet: ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à                        |           -0.00 | ‚úÖ ‚úÖ PASS
2. Cross-Sheet: ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£                        |           -0.00 | ‚úÖ ‚úÖ PASS
2. Cross-Sheet: ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£                             |           -0.00 | ‚úÖ ‚úÖ PASS
3. Tie-out: Report vs Financial Statement          |  156,555,067.05 | ‚ùå ‚ùå FAIL
   ‚îî‚îÄ ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡πÉ‡∏ô Report ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô (Text)
   ‚îî‚îÄ Report (GL ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à): 4,484,038,017.18
   ‚îî‚îÄ Financial Statement: 4,327,482,950.13
====================================================================================================
‡∏ú‡∏•‡∏£‡∏ß‡∏°: ‡∏ú‡πà‡∏≤‡∏ô 7 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ | ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
====================================================================================================
```

**‡∏Å‡∏≤‡∏£‡πÅ‡∏õ‡∏•‡∏ú‡∏•:**
- ‚ùå **FAIL** = ‡∏û‡∏ö‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á‡πÄ‡∏Å‡∏¥‡∏ô tolerance
- üìä ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î: ‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å‡∏ó‡∏±‡πâ‡∏á 2 ‡πÅ‡∏´‡∏•‡πà‡∏á ‡πÅ‡∏•‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á
- ‚ö†Ô∏è **7/8 PASS (87.5%)** = ‡∏Ñ‡∏ß‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô

---

### **2. ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö Combined Output**

#### **‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö:**

```bash
python3 report_generator/reconciliation/pl_reconciliation_combined.py
```

#### **‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏à‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:**

**‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏á‡∏ß‡∏î (MTH ‡πÅ‡∏•‡∏∞ YTD):**

| # | ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö | ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì |
|---|--------------|----------|
| 1 | ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ | ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ (‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏° R10) - ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ (‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏° C17) + ‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏Ø + ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô - ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏≠‡∏∑‡πà‡∏ô |
| 2 | ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏° | ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ + ‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏Ø + ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô |

**‡∏£‡∏ß‡∏°:** 2 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠ 1 ‡∏á‡∏ß‡∏î ‚Üí **‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î 4 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£**

#### **‚úÖ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå - ‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£**

```
====================================================================================================
                                       ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô (MTH)
====================================================================================================

üìä ‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå Combined (MTH):
  - ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£:            2,981,973,547.08
  - ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢:                  3,520,174,661.44
  - ‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô:           170,467,552.54
  - ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô:                    121,234,937.71
  - ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏≠‡∏∑‡πà‡∏ô:                236,798,005.17
  ------------------------------------------------------------
  - ‡∏Å‡∏≥‡πÑ‡∏£(‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô)‡∏™‡∏∏‡∏ó‡∏ò‡∏¥:            -483,296,629.28
  - ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏° (‡∏£‡∏ß‡∏°‡∏≠‡∏∑‡πà‡∏ô):         3,273,676,037.33

üîç ‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏Å‡∏±‡∏ö Source CSV (MTH):
  - ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏à‡∏≤‡∏Å CSV:             -483,296,629.28
  - ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥‡∏à‡∏≤‡∏Å Combined:        -483,296,629.28
  - ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á:                                0.00  ‚úÖ PASS

  - ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏°‡∏à‡∏≤‡∏Å CSV:           3,273,676,037.33
  - ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏°‡∏à‡∏≤‡∏Å Combined:      3,273,676,037.33
  - ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á:                               -0.00  ‚úÖ PASS

====================================================================================================
                                          ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
====================================================================================================
MTH: ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ (Source vs Combined)                |                 0.00 | ‚úÖ PASS
MTH: ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏° (Source vs Combined)                |                -0.00 | ‚úÖ PASS
YTD: ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ (Source vs Combined)                |                 0.00 | ‚úÖ PASS
YTD: ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏° (Source vs Combined)                |                 0.00 | ‚úÖ PASS
====================================================================================================
‡∏ú‡∏•‡∏£‡∏ß‡∏°: ‡∏ú‡πà‡∏≤‡∏ô 4 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ | ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô 0 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
====================================================================================================
```

**‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Combined Output:**
- ‚ö†Ô∏è **‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏±‡∏î R10 ‡∏≠‡∏≠‡∏Å** ‡∏à‡∏≤‡∏Å `revenue_gl_group` (‡πÄ‡∏û‡∏£‡∏≤‡∏∞ R10 ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô `summary_other`)
- ‚ö†Ô∏è **‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏±‡∏î C17 ‡∏≠‡∏≠‡∏Å** ‡∏à‡∏≤‡∏Å `expense_gl_group` (‡πÄ‡∏û‡∏£‡∏≤‡∏∞ C17 ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô `summary_other`)
- ‚úÖ ‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á: `(‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ - R10) - (‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢ - C17) + R10 - C17 ‡∏à‡∏≤‡∏Å summary_other`

---

## üîç ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤

### **‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô**

```bash
# 1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô folder ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
ls -la report_generator/reconciliation/*.xlsx
ls -la report_generator/reconciliation/*.csv
ls -la report_generator/reconciliation/*.txt

# 2. ‡∏î‡∏π Sheet names ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå Excel
python3 -c "import pandas as pd; xl = pd.ExcelFile('report_generator/reconciliation/Report_NT_202510.xlsx'); print('\n'.join(xl.sheet_names))"

# ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡πÑ‡∏î‡πâ:
# ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô_‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à
# ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô_‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£
# ‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô_‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£
# ‡∏´‡∏°‡∏ß‡∏î‡∏ö‡∏±‡∏ç‡∏ä‡∏µ_‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à
# ‡∏´‡∏°‡∏ß‡∏î‡∏ö‡∏±‡∏ç‡∏ä‡∏µ_‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£
# ‡∏´‡∏°‡∏ß‡∏î‡∏ö‡∏±‡∏ç‡∏ä‡∏µ_‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£

# 3. ‡∏î‡∏π Column names ‡πÉ‡∏ô CSV
python3 -c "import pandas as pd; df = pd.read_csv('report_generator/reconciliation/TRN_PL_GLGROUP_NT_MTH_TABLE_20251031.csv', encoding='cp874'); print(df.columns.tolist())"

# ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏Ñ‡∏ß‡∏£‡πÑ‡∏î‡πâ:
# ['GROUP', 'VALUE', ...]
```

---

### **‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏¢‡∏Å‡∏™‡πà‡∏ß‡∏ô**

#### **‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå CSV:**

```python
import pandas as pd

# ‡∏≠‡πà‡∏≤‡∏ô CSV
df = pd.read_csv('report_generator/reconciliation/TRN_PL_GLGROUP_NT_MTH_TABLE_20251031.csv', encoding='cp874')

# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
print("Total rows:", len(df))
print("\nFirst 5 rows:")
print(df.head())

# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥
net_profit = df[df['GROUP'].str.contains('05.‡∏Å‡∏≥‡πÑ‡∏£(‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô) ‡∏™‡∏∏‡∏ó‡∏ò‡∏¥', na=False, regex=False)]['VALUE'].sum()
print(f"\nNet Profit from CSV: {net_profit:,.2f}")
```

#### **‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå Excel:**

```python
import pandas as pd

# ‡∏≠‡πà‡∏≤‡∏ô Excel
df = pd.read_excel('report_generator/reconciliation/Report_NT_202510.xlsx',
                    sheet_name='‡∏´‡∏°‡∏ß‡∏î‡∏ö‡∏±‡∏ç‡∏ä‡∏µ_‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à',
                    header=None)

# ‡πÅ‡∏™‡∏î‡∏á‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ "‡∏Å‡∏≥‡πÑ‡∏£"
profit_rows = df[df[1].astype(str).str.contains('‡∏Å‡∏≥‡πÑ‡∏£', na=False)]
print(profit_rows[[1, 2]])
```

#### **‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå Text:**

```python
# ‡∏≠‡πà‡∏≤‡∏ô Text file
with open('report_generator/reconciliation/pld_nt_20251031.txt', 'r', encoding='cp874') as f:
    lines = f.readlines()

# ‡πÅ‡∏™‡∏î‡∏á‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ß‡πà‡∏≤ "‡∏Å‡∏≥‡πÑ‡∏£" ‡πÅ‡∏•‡∏∞ "‡∏™‡∏∏‡∏ó‡∏ò‡∏¥"
for i, line in enumerate(lines):
    if '‡∏Å‡∏≥‡πÑ‡∏£' in line and '‡∏™‡∏∏‡∏ó‡∏ò‡∏¥' in line:
        print(f"Line {i}: {line.strip()}")
```

---

### **‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢‡πÅ‡∏•‡∏∞‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ**

#### **1. ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå (FileNotFoundError)**

**‡∏≠‡∏≤‡∏Å‡∏≤‡∏£:**
```
Error: [Errno 2] No such file or directory: 'report_generator/reconciliation/Report_NT_202510.xlsx'
```

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
```bash
# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö current working directory
pwd

# ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà /Users/seal/Documents/GitHub/univer
cd /Users/seal/Documents/GitHub/univer

# ‡∏£‡∏±‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
python3 report_generator/reconciliation/pl_reconciliation_enhanced.py
```

---

#### **2. Sheet Name ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á (ValueError/KeyError)**

**‡∏≠‡∏≤‡∏Å‡∏≤‡∏£:**
```
ValueError: Worksheet '‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô_‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à' not found
```

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**
```bash
# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ä‡∏∑‡πà‡∏≠ sheet ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏£‡∏¥‡∏á
python3 -c "import pandas as pd; xl = pd.ExcelFile('report_generator/reconciliation/Report_NT_202510.xlsx'); print(xl.sheet_names)"

# ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ä‡∏∑‡πà‡∏≠ sheet ‡πÉ‡∏ô pl_reconciliation_enhanced.py:
sheets = {
    'cost_biz': '‡∏ä‡∏∑‡πà‡∏≠_sheet_‡∏ó‡∏µ‡πà_‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á',  # ‚Üê ‡πÅ‡∏Å‡πâ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
    ...
}
```

---

#### **3. ‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡∏°‡∏≤‡∏Å**

**‡∏≠‡∏≤‡∏Å‡∏≤‡∏£:**
```
‚ùå FAIL | ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á: 2,981,973,547.08
```

**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ:**

**A. ‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô (MTH vs YTD):**
```bash
# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏á‡∏ß‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô
# ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ _MTH_ ‡∏´‡∏£‡∏∑‡∏≠ _YTD_ ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô

# ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å:
Report_NT_202510.xlsx  <-- MTH
TRN_PL_GLGROUP_NT_MTH_TABLE_20251031.csv  <-- MTH ‚úì

# ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î:
Report_NT_202510.xlsx  <-- MTH
TRN_PL_GLGROUP_NT_YTD_TABLE_20251031.csv  <-- YTD ‚úó
```

**B. ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å Excel ‡∏ú‡∏¥‡∏î column:**

‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÉ‡∏ä‡πâ keyword ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á:
- Cost Sheet: ‡πÉ‡∏ä‡πâ `"‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£"` (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà "‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ")
- GL Sheet: ‡πÉ‡∏ä‡πâ `"‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ"` (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà "‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£")

**C. ‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏•‡∏∑‡∏≠‡∏Å column ‡∏ú‡∏¥‡∏î:**

```python
# MTH ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å column 0 (column ‡πÅ‡∏£‡∏Å)
# YTD ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å column 1 (column ‡∏ó‡∏µ‡πà‡∏™‡∏≠‡∏á)

# ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:
col_idx = 0 if period_type == PeriodType.MTH else 1
```

---

#### **4. Encoding Error**

**‡∏≠‡∏≤‡∏Å‡∏≤‡∏£:**
```
UnicodeDecodeError: 'utf-8' codec can't decode byte
```

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ:**

‡πÇ‡∏Ñ‡πâ‡∏î‡πÉ‡∏ä‡πâ `encoding='cp874'` ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå CSV ‡πÅ‡∏•‡∏∞ Text ‡πÅ‡∏•‡πâ‡∏ß

‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö encoding ‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå:
```bash
file -I report_generator/reconciliation/pld_nt_20251031.txt
# ‡∏Ñ‡∏ß‡∏£‡πÅ‡∏™‡∏î‡∏á: charset=windows-874 ‡∏´‡∏£‡∏∑‡∏≠ charset=tis-620
```

---

## üîß ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡πÅ‡∏•‡∏∞‡∏Ç‡∏¢‡∏≤‡∏¢‡∏ú‡∏•

### **1. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÉ‡∏´‡∏°‡πà**

‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ô class `ReconciliationEngine`:

```python
def run_all_checks(self):
    values = self.extract_values()

    # ... ‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏î‡∏¥‡∏° ...

    # ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÉ‡∏´‡∏°‡πà
    self._check_expense_completeness(values)

def _check_expense_completeness(self, values: Dict[str, float]):
    """‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢"""
    self.results.append(ReconciliationResult(
        check_name="Expense Check",
        description="‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏à‡∏≤‡∏Å CSV ‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö Report",
        value1=values.get('src_gl_expense', 0),
        value1_label="Source CSV",
        value2=values.get('rep_gl_biz_expense', 0),
        value2_label="Report"
    ))
```

### **2. ‡∏õ‡∏£‡∏±‡∏ö Tolerance**

‡∏Ñ‡πà‡∏≤ tolerance default ‡∏Ñ‡∏∑‡∏≠ 1.0 ‡∏ö‡∏≤‡∏ó ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏õ‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ:

```python
self.results.append(ReconciliationResult(
    check_name="...",
    description="...",
    value1=val1,
    value2=val2,
    tolerance=100.0  # ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏õ‡πá‡∏ô 100 ‡∏ö‡∏≤‡∏ó
))
```

### **3. ‡πÄ‡∏û‡∏¥‡πà‡∏° Sheet ‡πÉ‡∏´‡∏°‡πà**

‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏° Sheet ‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô `FileConfig`:

```python
sheets = {
    'cost_biz': '‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô_‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à',
    'cost_service_group': '‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô_‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£',
    'cost_service': '‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô_‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£',
    'gl_biz': '‡∏´‡∏°‡∏ß‡∏î‡∏ö‡∏±‡∏ç‡∏ä‡∏µ_‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à',
    'gl_service_group': '‡∏´‡∏°‡∏ß‡∏î‡∏ö‡∏±‡∏ç‡∏ä‡∏µ_‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£',
    'gl_service': '‡∏´‡∏°‡∏ß‡∏î‡∏ö‡∏±‡∏ç‡∏ä‡∏µ_‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£',
    'my_custom_sheet': '‡∏ä‡∏∑‡πà‡∏≠_Sheet_‡πÉ‡∏´‡∏°‡πà',  # ‚Üê ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
}
```

---

## üìö ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°

### **‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö 3 ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°**

| ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå | pl_reconciliation.py | pl_reconciliation_enhanced.py | pl_reconciliation_combined.py |
|---------|---------------------|------------------------------|------------------------------|
| **‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢** | Excel (2 sheets) | Excel (6 sheets) | Combined Output |
| **‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö MTH/YTD** | ‚ùå MTH ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô | ‚úÖ ‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏π‡πà | ‚úÖ ‡∏ó‡∏±‡πâ‡∏á‡∏Ñ‡∏π‡πà |
| **‡∏ï‡∏£‡∏ß‡∏à‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ** | ‚ùå | ‚úÖ | ‚úÖ |
| **‡∏ï‡∏£‡∏ß‡∏à‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥** | ‚úÖ | ‚úÖ | ‚úÖ |
| **Cross-Sheet** | 1 ‡∏Ñ‡∏π‡πà | 3 ‡∏Ñ‡∏π‡πà | ‡πÑ‡∏°‡πà‡∏°‡∏µ |
| **Tie-out** | ‚úÖ | ‚úÖ | ‚ùå |
| **‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö** | 3 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ | 16 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ | 4 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ |
| **Code Structure** | Procedural | OOP (Class) | Hybrid |

### **Keywords ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤**

#### **‡πÉ‡∏ô CSV Source:**
```python
# Cost Type
'01.‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ'                    # ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ
'14.‡∏Å‡∏≥‡πÑ‡∏£(‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô) ‡∏™‡∏∏‡∏ó‡∏ò‡∏¥'        # ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥

# GL Group
'01.‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ'                    # ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ
'02.‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢'                # ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢
'05.‡∏Å‡∏≥‡πÑ‡∏£(‡∏Ç‡∏≤‡∏î‡∏ó‡∏∏‡∏ô) ‡∏™‡∏∏‡∏ó‡∏ò‡∏¥'        # ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥
```

#### **‡πÉ‡∏ô Excel Report:**
```python
# Cost Sheet
['‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£']              # ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ (Cost Type)
['‡∏Å‡∏≥‡πÑ‡∏£', '‡∏™‡∏∏‡∏ó‡∏ò‡∏¥']              # ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥

# GL Sheet
['‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ']                  # ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ (GL Group)
['‡∏Å‡∏≥‡πÑ‡∏£', '‡∏™‡∏∏‡∏ó‡∏ò‡∏¥']              # ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥
```

#### **‡πÉ‡∏ô Text ‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô:**
```python
['‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ', '‡∏£‡∏ß‡∏°']              # ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏°
['‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢', '‡∏£‡∏ß‡∏°']          # ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏ß‡∏°
['‡∏Å‡∏≥‡πÑ‡∏£', '‡∏™‡∏∏‡∏ó‡∏ò‡∏¥']              # ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥

# Column selection:
# MTH = column_index 0
# YTD = column_index 1
```

#### **‡πÉ‡∏ô Combined Output:**
```python
# revenue_gl_group
'R10'  # ‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô (‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏±‡∏î‡∏≠‡∏≠‡∏Å)

# expense_gl_group
'C17'  # ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏≠‡∏∑‡πà‡∏ô (‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏±‡∏î‡∏≠‡∏≠‡∏Å)

# summary_other
'‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô'
'‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô'
'‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏≠‡∏∑‡πà‡∏ô'
```

---

## üéì ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### **1. ‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏ö‡∏ö‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß**

```bash
# ‡∏£‡∏±‡∏ô‡πÅ‡∏Ñ‡πà‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏ô‡πÉ‡∏à ‡πÇ‡∏î‡∏¢‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç main() ‡πÉ‡∏ô code:
def main():
    # Comment ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö
    engine_mth = ReconciliationEngine(config_mth)
    engine_mth.run_all_checks()
    engine_mth.print_results()

    # Comment YTD ‡∏≠‡∏≠‡∏Å‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö
    # engine_ytd = ReconciliationEngine(config_ytd)
    # engine_ytd.run_all_checks()
    # engine_ytd.print_results()
```

### **2. ‡∏Å‡∏≤‡∏£ Export ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå**

```bash
# Export ‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå text
python3 report_generator/reconciliation/pl_reconciliation_enhanced.py > reconciliation_results.txt

# ‡∏î‡∏π‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
cat reconciliation_results.txt
```

### **3. ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏´‡∏•‡∏≤‡∏¢‡∏á‡∏ß‡∏î**

‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô:

```bash
#!/bin/bash
# compare_months.sh

months=("202509" "202510" "202511")

for month in "${months[@]}"; do
    echo "Testing month: $month"
    # ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç config ‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î‡πÉ‡∏´‡πâ‡∏ä‡∏µ‡πâ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡πÜ
    python3 report_generator/reconciliation/pl_reconciliation_enhanced.py
done
```

---

## üìù Checklist ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö

‡πÉ‡∏ä‡πâ checklist ‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏ß‡πà‡∏≤‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏û‡∏£‡πâ‡∏≠‡∏°:

### **‡∏Å‡πà‡∏≠‡∏ô‡∏£‡∏±‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°:**
- [ ] ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Python 3.7+ ‡πÅ‡∏•‡πâ‡∏ß
- [ ] ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á pandas ‡πÅ‡∏•‡∏∞ openpyxl ‡πÅ‡∏•‡πâ‡∏ß
- [ ] ‡πÑ‡∏ü‡∏•‡πå Excel Report ‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô folder ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- [ ] ‡πÑ‡∏ü‡∏•‡πå CSV ‡∏ï‡πâ‡∏ô‡∏ó‡∏≤‡∏á (Cost Type ‡πÅ‡∏•‡∏∞ GL Group) ‡∏û‡∏£‡πâ‡∏≠‡∏°
- [ ] ‡πÑ‡∏ü‡∏•‡πå Text ‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°
- [ ] ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô Configuration ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
- [ ] ‡∏á‡∏ß‡∏î‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô (MTH ‡∏Å‡∏±‡∏ö MTH, YTD ‡∏Å‡∏±‡∏ö YTD)

### **‡∏´‡∏•‡∏±‡∏á‡∏£‡∏±‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°:**
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô/‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô
- [ ] ‡∏≠‡πà‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô
- [ ] ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏õ‡πá‡∏ô audit trail
- [ ] ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡πÉ‡∏´‡πâ‡∏ó‡∏µ‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏ó‡∏£‡∏≤‡∏ö

---

## üë®‚Äçüíª ‡∏ú‡∏π‡πâ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô

**Version:** 2.0 (Enhanced)
**Last Updated:** December 2025
**Python Version:** 3.7+
**Dependencies:** pandas, openpyxl

**Contact:** ‡∏´‡∏≤‡∏Å‡∏û‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ feature ‡πÉ‡∏´‡∏°‡πà ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ó‡∏µ‡∏° Data Engineering

---

## üìù License

Internal use only - ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡πÇ‡∏ó‡∏£‡∏Ñ‡∏°‡∏ô‡∏≤‡∏Ñ‡∏°‡πÅ‡∏´‡πà‡∏á‡∏ä‡∏≤‡∏ï‡∏¥ ‡∏à‡∏≥‡∏Å‡∏±‡∏î (‡∏°‡∏´‡∏≤‡∏ä‡∏ô)

---

## üìñ ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á

- [Reconciliation.md](Reconciliation.md) - ‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡πÅ‡∏•‡∏∞‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
- [pl_reconciliation_enhanced.py](pl_reconciliation_enhanced.py) - Source code ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏´‡∏•‡∏±‡∏Å
- [pl_reconciliation_combined.py](pl_reconciliation_combined.py) - Source code ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Combined Output

---

**‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:** ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏∞‡∏¢‡∏∞ ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î‡πÄ‡∏™‡∏°‡∏≠
