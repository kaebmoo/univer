# ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô: ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô P&L (Enhanced Version)

## üìã ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°

‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô P&L ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏° ‡πÇ‡∏î‡∏¢‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö:

- ‚úÖ **‡∏ó‡∏∏‡∏Å Sheet** - ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏£‡∏ö 6 sheets (3 ‡∏°‡∏¥‡∏ï‡∏¥‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô + 3 ‡∏°‡∏¥‡∏ï‡∏¥ GL)
- ‚úÖ **‡∏ó‡∏±‡πâ‡∏á MTH ‡πÅ‡∏•‡∏∞ YTD** - ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏∞‡∏™‡∏°
- ‚úÖ **3 Validation Modes** - Basic, Enhanced, Comprehensive
- ‚úÖ **Command Line Interface** - ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á!

---

## üéØ Validation Modes

### Mode 1: Basic (Phase 1)
‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏Ñ‡πà **Net Profit** ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô

**‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à:**
- ‚úì Completeness: Source CSV vs Report (Net Profit)
- ‚úì Cross-Sheet Consistency: Net Profit (3 ‡∏Ñ‡∏π‡πà)
- ‚úì Tie-out: Report vs Financial Statement

### Mode 2: Enhanced (Phase 2) [DEFAULT]
‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö **Revenue, Expense, Net Profit + Internal Math**

**‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à:**
- ‚úì ‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏ô Basic Mode
- ‚úì Cross-Sheet: Revenue (3 ‡∏Ñ‡∏π‡πà)
- ‚úì Cross-Sheet: Expense (3 ‡∏Ñ‡∏π‡πà)
- ‚úì Internal Math: Revenue - Expense - Tax = Net Profit (6 sheets)

### Mode 3: Comprehensive (Phase 3)
‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö **‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏ß‡∏°‡∏ñ‡∏∂‡∏á Drill-Down**

**‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à:**
- ‚úì ‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÉ‡∏ô Enhanced Mode
- ‚úì Drill-Down: ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ ‚Üí ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ ‚Üí ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à (Coming soon)

---

## üöÄ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### **‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Dependencies**

```bash
# ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Python packages ‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô
pip install pandas openpyxl
```

**Requirements:**
- Python 3.7 ‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ
- pandas >= 1.3.0
- openpyxl >= 3.0.0

---

### **‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÑ‡∏ü‡∏•‡πå**

‡∏ß‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô folder `report_generator/reconciliation/`

**‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô:**

```
MTH (‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô):
‚îú‚îÄ‚îÄ Report_{COMPANY}_{YYYYMM}.xlsx               # ‡πÄ‡∏ä‡πà‡∏ô Report_NT_202510.xlsx
‚îú‚îÄ‚îÄ TRN_PL_COSTTYPE_{COMPANY}_MTH_TABLE_{YYYYMMDD}.csv
‚îú‚îÄ‚îÄ TRN_PL_GLGROUP_{COMPANY}_MTH_TABLE_{YYYYMMDD}.csv
‚îî‚îÄ‚îÄ pld_{company}_{YYYYMMDD}.txt                 # ‡πÄ‡∏ä‡πà‡∏ô pld_nt_20251031.txt

YTD (‡∏™‡∏∞‡∏™‡∏°):
‚îú‚îÄ‚îÄ Report_{COMPANY}_{YYYY}.xlsx                 # ‡πÄ‡∏ä‡πà‡∏ô Report_NT_2025.xlsx
‚îú‚îÄ‚îÄ TRN_PL_COSTTYPE_{COMPANY}_YTD_TABLE_{YYYYMMDD}.csv
‚îú‚îÄ‚îÄ TRN_PL_GLGROUP_{COMPANY}_YTD_TABLE_{YYYYMMDD}.csv
‚îî‚îÄ‚îÄ pld_{company}_{YYYYMMDD}.txt                 # ‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ö MTH
```

---

### **‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏£‡∏±‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°**

#### **üåü ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: ‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ú‡πà‡∏≤‡∏ô Command Line (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)**

```bash
# ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏ó‡∏µ‡πà folder ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå
cd /path/to/report_generator/reconciliation

# ‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà (‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 31 ‡∏ï.‡∏Ñ. 2025)
python pl_reconciliation_enhanced.py --date 20251031

# ‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà + mode
python pl_reconciliation_enhanced.py --date 20251031 --mode enhanced

# ‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà + mode + company
python pl_reconciliation_enhanced.py --date 20251130 --mode basic --company NT
```

**‡∏Ç‡πâ‡∏≠‡∏î‡∏µ:**
- ‚úÖ ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
- ‚úÖ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢
- ‚úÖ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö automation

**‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏à‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥:**
- ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà `20251031` ‚Üí ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô `202510` ‚Üí ‡∏õ‡∏µ `2025`
- `Report_NT_202510.xlsx` (MTH)
- `Report_NT_2025.xlsx` (YTD)
- `TRN_PL_COSTTYPE_NT_MTH_TABLE_20251031.csv`
- `pld_nt_20251031.txt`

---

#### **‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤ Default ‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î**

```bash
# ‡∏£‡∏±‡∏ô‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà (‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î)
python pl_reconciliation_enhanced.py --mode enhanced
```

**‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏µ‡∏¢:**
- ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
- ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ô `main()` function (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 642-658)

---

### **Command Line Options**

```bash
python pl_reconciliation_enhanced.py --help
```

**Parameters:**
- `--date YYYYMMDD`: ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô (‡πÄ‡∏ä‡πà‡∏ô 20251031) [Optional]
- `--mode {basic|enhanced|comprehensive}`: ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö [Default: enhanced]
- `--company CODE`: ‡∏£‡∏´‡∏±‡∏™‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó [Default: NT]

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:**

```bash
# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏ï.‡∏Ñ. 2025 (Enhanced mode)
python pl_reconciliation_enhanced.py --date 20251031

# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏û.‡∏¢. 2025 (Basic mode)
python pl_reconciliation_enhanced.py --date 20251130 --mode basic

# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏ò.‡∏Ñ. 2025 (Comprehensive mode)
python pl_reconciliation_enhanced.py --date 20251231 --mode comprehensive

# ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏≠‡∏∑‡πà‡∏ô
python pl_reconciliation_enhanced.py --date 20251031 --company ABC
```

---

## üìä ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ

### **Mode: Enhanced (Default)**

```
üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô: 31/10/2025
üè¢ ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó: NT

====================================================================================================
                       ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô P&L
                                     Validation Mode: ENHANCED
====================================================================================================

================================================================================
‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö: MTH [Mode: ENHANCED]
================================================================================

üìä ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà 1: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô (Completeness)
--------------------------------------------------------------------------------

üîÑ ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà 2: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á (Cross-Sheet Consistency)
--------------------------------------------------------------------------------

üßÆ ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà 2d: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏†‡∏≤‡∏¢‡πÉ‡∏ô (Internal Math)
--------------------------------------------------------------------------------

‚úì ‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà 3: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Tie-out (Financial Statement)
--------------------------------------------------------------------------------

====================================================================================================
                                          ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
====================================================================================================
‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö                                      |        ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á | ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
====================================================================================================
1.1a Revenue: Source Cost vs Report                |            0.00 | ‚úÖ ‚úÖ PASS
1.1b Net Profit: Source Cost vs Report             |           -0.00 | ‚úÖ ‚úÖ PASS
1.2a Revenue: Source GL vs Report                  |           -0.00 | ‚úÖ ‚úÖ PASS
1.2b Net Profit: Source GL vs Report               |            0.00 | ‚úÖ ‚úÖ PASS
2a. Cross-Sheet Revenue: ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à               |            0.00 | ‚úÖ ‚úÖ PASS
2b. Cross-Sheet Expense: ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à               |           -0.00 | ‚úÖ ‚úÖ PASS
2c. Cross-Sheet Net Profit: ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à            |            0.00 | ‚úÖ ‚úÖ PASS
2a. Cross-Sheet Revenue: ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£               |            0.00 | ‚úÖ ‚úÖ PASS
2b. Cross-Sheet Expense: ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£               |           -0.00 | ‚úÖ ‚úÖ PASS
2c. Cross-Sheet Net Profit: ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£            |            0.00 | ‚úÖ ‚úÖ PASS
2a. Cross-Sheet Revenue: ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£                    |            0.00 | ‚úÖ ‚úÖ PASS
2b. Cross-Sheet Expense: ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£                    |           -0.00 | ‚úÖ ‚úÖ PASS
2c. Cross-Sheet Net Profit: ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£                 |            0.00 | ‚úÖ ‚úÖ PASS
2d. Internal Math: Cost Type - ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à         |            0.00 | ‚úÖ ‚úÖ PASS
2d. Internal Math: Cost Type - ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£         |            0.00 | ‚úÖ ‚úÖ PASS
2d. Internal Math: Cost Type - ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£              |            0.00 | ‚úÖ ‚úÖ PASS
2d. Internal Math: GL Group - ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à          |            0.00 | ‚úÖ ‚úÖ PASS
2d. Internal Math: GL Group - ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£          |            0.00 | ‚úÖ ‚úÖ PASS
2d. Internal Math: GL Group - ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£               |            0.00 | ‚úÖ ‚úÖ PASS
3. Tie-out: Report vs Financial Statement          |           -0.00 | ‚úÖ ‚úÖ PASS
====================================================================================================
‡∏ú‡∏•‡∏£‡∏ß‡∏°: ‡∏ú‡πà‡∏≤‡∏ô 20 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ | ‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô 0 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
====================================================================================================
```

### **‡∏™‡∏£‡∏∏‡∏õ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:**

| Mode | MTH | YTD | ‡∏£‡∏ß‡∏° |
|------|-----|-----|-----|
| **Basic** | 8 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ | 8 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ | **16 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£** |
| **Enhanced** | 20 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ | 20 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ | **40 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£** |
| **Comprehensive** | TBD | TBD | TBD |

---

## üéØ ‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö

### **‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà 1: Completeness (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô)**
```
Source CSV ‚Üí Report Excel
```
‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å CSV ‡∏ñ‡∏π‡∏Å‡∏ô‡∏≥‡∏°‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏£‡∏ö‡πÉ‡∏ô Report

**‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à:**
- ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏° (‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£ + ‡∏ú‡∏•‡∏ï‡∏≠‡∏ö‡πÅ‡∏ó‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏≠‡∏∑‡πà‡∏ô)
- ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥

### **‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà 2: Cross-Sheet Consistency (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á)**
```
Cost Type Sheet ‚ü∑ GL Group Sheet
```
‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡πà‡∏≤ 2 ‡∏°‡∏¥‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô ‡∏°‡∏µ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô

**‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à (Enhanced Mode):**
- ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏£‡∏ß‡∏° (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô)
- ‡∏Ñ‡πà‡∏≤‡πÉ‡∏ä‡πâ‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏ß‡∏° (‡∏£‡∏ß‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô)
- ‡∏Å‡∏≥‡πÑ‡∏£‡∏™‡∏∏‡∏ó‡∏ò‡∏¥ (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô)
- Internal Math: `Revenue - Expense - Tax = Net Profit`

### **‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ó‡∏µ‡πà 3: Financial Tie-out (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á)**
```
Report Excel ‚Üí Financial Statement (Text)
```
‡∏ï‡∏£‡∏ß‡∏à‡∏ß‡πà‡∏≤ Report Excel ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏á‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£

---

## üîß ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á

### **1. ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡πà‡∏≤ Default**

‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå `pl_reconciliation_enhanced.py` (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î 642-658):

```python
# ‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏ --date
config_mth = FileConfig(
    period_type=PeriodType.MTH,
    report_excel=str(script_dir / 'Report_NT_202510.xlsx'),  # ‚Üê ‡πÅ‡∏Å‡πâ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
    ...
)
```

### **2. ‡πÄ‡∏û‡∏¥‡πà‡∏° Tolerance**

‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ô `ReconciliationResult` (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î ~411):

```python
tolerance=10.0  # ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏õ‡πá‡∏ô 10 ‡∏ö‡∏≤‡∏ó (‡∏à‡∏≤‡∏Å 1.0)
```

### **3. ‡πÄ‡∏û‡∏¥‡πà‡∏° Sheet ‡πÉ‡∏´‡∏°‡πà**

‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÉ‡∏ô `FileConfig.__post_init__()` (‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î ~46):

```python
self.sheets = {
    'cost_biz': '‡∏ï‡πâ‡∏ô‡∏ó‡∏∏‡∏ô_‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à',
    'my_new_sheet': '‡∏ä‡∏∑‡πà‡∏≠_Sheet_‡πÉ‡∏´‡∏°‡πà',  # ‚Üê ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
    ...
}
```

---

## üîç Troubleshooting

### **1. ‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå (FileNotFoundError)**

```bash
# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà folder ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
pwd
cd /path/to/report_generator/reconciliation

# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏£‡∏¥‡∏á
ls -la *.xlsx *.csv *.txt
```

### **2. ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á**

```bash
‚ùå --date 2025-10-31  # ‡∏ú‡∏¥‡∏î
‚úÖ --date 20251031     # ‡∏ñ‡∏π‡∏Å (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô YYYYMMDD)
```

### **3. ‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô‡∏°‡∏≤‡∏Å**

‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤:
- ‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏•‡πå‡∏á‡∏ß‡∏î‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô (MTH ‡∏Å‡∏±‡∏ö MTH, YTD ‡∏Å‡∏±‡∏ö YTD)
- ‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏°‡πà‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢ (‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏î‡πâ‡πÉ‡∏ô Excel)
- Column names ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (GROUP, VALUE)

---

## üìù Checklist

### **‡∏Å‡πà‡∏≠‡∏ô‡∏£‡∏±‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°:**
- [ ] ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Python 3.7+ ‡πÅ‡∏•‡∏∞ dependencies
- [ ] ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô folder ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô
- [ ] ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏ï‡∏£‡∏á‡∏ï‡∏≤‡∏°‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô
- [ ] ‡∏á‡∏ß‡∏î‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô (MTH/YTD)

### **‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ --date:**
- [ ] ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (YYYYMMDD)
- [ ] ‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏°‡∏µ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô
- [ ] ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö pattern ‡∏ó‡∏µ‡πà‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á

---

## üí° Tips

### **1. Export ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå**

```bash
# ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü‡∏•‡πå
python pl_reconciliation_enhanced.py --date 20251031 > results.txt

# ‡∏î‡∏π‡πÅ‡∏Ñ‡πà‡∏™‡∏£‡∏∏‡∏õ
python pl_reconciliation_enhanced.py --date 20251031 | grep "‡∏ú‡∏•‡∏£‡∏ß‡∏°:"
```

### **2. Batch Processing**

‡∏™‡∏£‡πâ‡∏≤‡∏á script ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô:

```bash
#!/bin/bash
# check_all_months.sh

for date in 20250131 20250228 20250331; do
    echo "Checking: $date"
    python pl_reconciliation_enhanced.py --date $date --mode enhanced
done
```

### **3. ‡πÉ‡∏ä‡πâ Mode ‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°**

- **Basic**: ‡∏ï‡∏£‡∏ß‡∏à‡∏£‡∏ß‡∏î‡πÄ‡∏£‡πá‡∏ß, ‡∏î‡∏π‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°
- **Enhanced**: ‡∏ï‡∏£‡∏ß‡∏à‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î, ‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡∏à‡∏≥ (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)
- **Comprehensive**: ‡∏ï‡∏£‡∏ß‡∏à‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á, ‡πÉ‡∏ä‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤

---

## üìö ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á

- [Reconciliation.md](Reconciliation.md) - ‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡πÅ‡∏•‡∏∞‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£
- [pl_reconciliation_enhanced.py](pl_reconciliation_enhanced.py) - Source code

---

## üë®‚Äçüíª ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°

**Version:** 3.0 (Enhanced with CLI)
**Last Updated:** December 2025
**Python Version:** 3.7+
**Dependencies:** pandas, openpyxl

---

**Internal use only** - ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡πÇ‡∏ó‡∏£‡∏Ñ‡∏°‡∏ô‡∏≤‡∏Ñ‡∏°‡πÅ‡∏´‡πà‡∏á‡∏ä‡∏≤‡∏ï‡∏¥ ‡∏à‡∏≥‡∏Å‡∏±‡∏î (‡∏°‡∏´‡∏≤‡∏ä‡∏ô)
